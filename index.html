<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="$langISO" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type"/>
    <meta content="IE=11" http-equiv="X-UA-Compatible"/>
    <meta content="Doxygen 1.9.1" name="generator"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    <title>NE591-008 C++17 Codebase: NE591 Monorepo - Overview</title>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
    <script src="jquery.js" type="text/javascript"></script>
    <script src="dynsections.js" type="text/javascript"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
    <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    $darkmode
    <link href="doxygen.css" rel="stylesheet" type="text/css"/>
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
    <script src="doxygen-awesome-darkmode-toggle.js" type="text/javascript"></script>
    <script type="text/javascript">
        DoxygenAwesomeDarkModeToggle.init()
    </script>
    <script src="doxygen-awesome-interactive-toc.js" type="text/javascript"></script>
    <script type="text/javascript">
        DoxygenAwesomeInteractiveToc.init();
        DoxygenAwesomeInteractiveToc.topOffset = 200;
    </script>
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellpadding="0" cellspacing="0">
                <tbody>
                <tr id="projectrow">
                    <td id="projectalign">
                        <div id="projectname">NE591-008 C++17 Codebase
                        </div>
                    </td>
                </tr>
                <!--BEGIN FULL_SIDEBAR-->
                <tr>
                    <td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
                </tr>
                <!--END FULL_SIDEBAR-->
                </tbody>
            </table>
        </div>
        <!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">NE591 Monorepo - Overview </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1">Locating Source Files</a></li>
<li class="level1"><a href="#autotoc_md2">Building</a><ul><li class="level2"><a href="#autotoc_md3">Hazel</a><ul><li class="level3"><a href="#autotoc_md4">Interactive Mode</a></li>
<li class="level3"><a href="#autotoc_md5">Batch Jobs</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md6">EOS</a></li>
<li class="level2"><a href="#autotoc_md7">Build Environments</a><ul><li class="level3"><a href="#autotoc_md8">EOS</a></li>
<li class="level3"><a href="#autotoc_md9">Hazel</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md10">Class Project</a></li>
<li class="level2"><a href="#autotoc_md11">InLabs and OutLabs</a></li>
<li class="level2"><a href="#autotoc_md12">Optional CMake Arguments</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md13">Docker Usage Guide</a><ul><li class="level2"><a href="#autotoc_md14">Why Docker?</a></li>
<li class="level2"><a href="#autotoc_md15">Building the Docker Image</a></li>
<li class="level2"><a href="#autotoc_md16">Running the Docker Container</a></li>
<li class="level2"><a href="#autotoc_md17">Building and Running Tests</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md18">Development - JetBrains Clion Support</a><ul><li class="level2"><a href="#autotoc_md19">Prerequisites</a></li>
<li class="level2"><a href="#autotoc_md20">Clion Docker Toolchain</a><ul><li class="level3"><a href="#autotoc_md21">Instructions</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md22">Troubleshooting</a></li>
<li class="level2"><a href="#autotoc_md23">Clion Remote Debugging via SSH</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md24">License</a></li>
<li class="level1"><a href="#autotoc_md25">FAQs</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_README"></a> This is a monorepo for my class project and inlab, outlab deliverables for the <code>NE591-008</code> course, titled <code>Mathematical and Computational Methods in Nuclear Engineering</code>. The course aims to provide a theoretical foundation of mathematical methods applied broadly in nuclear engineering and to construct algorithms to implement the resulting formalisms on digital computers. The labs involve designing computer programs in low-level languages (exclusively Fortran or C++) and their implementation, verification, and testing. I have chosen to organize this repo in a manner that builds on the cumulative code changes from each deliverable, and reuses as many helper functions as possible. A secondary objective is to benchmark my implementations against the <code>C++17</code>, <code>CUDA</code>, and <code>Boost</code> library functions.</p>
<div style="display: none"></div><ol type="1">
<li><a href="#locating-source-files">Locating Source Files</a></li>
<li><a href="#building">Building</a><ul>
<li><a href="#build-environments">Build Environments</a><ul>
<li><a href="#eos">EOS</a></li>
<li><a href="#hazel">Hazel</a></li>
</ul>
</li>
<li><a href="#class-project">Class Project</a></li>
<li><a href="#inlabs-and-outlabs">InLabs and OutLabs</a></li>
<li><a href="#optional-cmake-arguments">Optional CMake Arguments</a></li>
</ul>
</li>
<li><a href="#docker-usage-guide">Docker Usage Guide</a><ul>
<li><a href="#why-docker">Why Docker?</a></li>
<li><a href="#building-the-docker-image">Building the Docker Image</a></li>
<li><a href="#running-the-docker-container">Running the Docker Container</a></li>
<li><a href="#building-and-running-tests">Building and Running Tests</a></li>
</ul>
</li>
<li><a href="#development---jetbrains-clion-support">Development - JetBrains Clion Support</a><ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#clion-docker-toolchain">Clion Docker Toolchain</a><ul>
<li><a href="#instructions">Instructions</a></li>
<li><a href="#troubleshooting">Troubleshooting Windows Issues</a></li>
</ul>
</li>
<li><a href="#clion-remote-debugging-via-ssh">Clion Remote Debugging via SSH</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
<li><a href="#faqs">FAQs</a></li>
</ol>
<h1><a class="anchor" id="autotoc_md1"></a>
Locating Source Files</h1>
<p>Sources and file paths for each deliverable follow the following structure:</p>
<div class="fragment"><div class="line">├── README.md   &lt;= You are now here</div>
<div class="line">├── src</div>
<div class="line">│   ├── project     &lt;= Class project deliverables</div>
<div class="line">│   │   ├── project1</div>
<div class="line">│   │   │   ├── main.cpp         &lt;= Stub entrypoint main() method</div>
<div class="line">│   │   │   ├── project1.cpp     &lt;= run() method</div>
<div class="line">│   │   │   ├── Compute.h        &lt;= Core compute logic</div>
<div class="line">│   │   │   ├── Parser.h         &lt;= Argument parsing and error checking </div>
<div class="line">│   │   │   ├── InputOutputs.h   &lt;= Struct definitions for file I/O</div>
<div class="line">│   │   │   ├── README.md        &lt;= Usage and examples</div>
<div class="line">│   │   │   ├── examples         &lt;= Directory with example inputs and outputs</div>
<div class="line">│   │   │   ├── tests            &lt;= CTests implemented using Google Test Suite</div>
<div class="line">│   │   │   ├── ...</div>
<div class="line">│   │   ├── project2</div>
<div class="line">│   │   ├── ...</div>
<div class="line">│   ├── labs        &lt;= InLab, OutLab deliverables</div>
<div class="line">│   │   ├── inlab1</div>
<div class="line">│   │   │   ├── main.cpp         &lt;= Stub entrypoint main() method</div>
<div class="line">│   │   │   ├── inlab1.cpp       &lt;= run() method</div>
<div class="line">│   │   │   ├── Compute.h        &lt;= Core compute logic</div>
<div class="line">│   │   │   ├── Parser.h         &lt;= Argument parsing and error checking </div>
<div class="line">│   │   │   ├── InputOutputs.h   &lt;= Struct definitions for file I/O</div>
<div class="line">│   │   │   ├── README.md        &lt;= Usage and examples</div>
<div class="line">│   │   │   ├── examples         &lt;= Directory with example inputs and outputs</div>
<div class="line">│   │   │   ├── tests            &lt;= CTests implemented using Google Test Suite</div>
<div class="line">│   │   │   ├── ...</div>
<div class="line">│   │   ├── outlab1</div>
<div class="line">│   │   ├── inlab2</div>
<div class="line">│   │   ├── outlab2</div>
<div class="line">│   │   ├── ...</div>
<div class="line">│   ├── utils                        &lt;= Helper methods</div>
<div class="line">│   │   ├── math                     </div>
<div class="line">│   │   │   ├── blas                 &lt;= Self implemented Math, BLAS libraries</div>
<div class="line">│   │   ├── CheckBounds.h</div>
<div class="line">│   │   ├── CommandLine.h            &lt;= Other helper functions</div>
<div class="line">│   │   ├── ...</div>
<div class="line">├── ...</div>
<div class="line">├── external                     &lt;= External dependencies</div>
</div><!-- fragment --><p>The <code>utils</code> directory contains helper methods used across the project. These include a helper math library, methods for checking bounds, interacting with the command line, I/O operations on CSV and JSON files, general helper functions, and a high-precision profiler for performance analysis.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Building</h1>
<p>The code has been built and tested on the NCSU Hazel<code>login.hpc.ncsu.edu</code> and NCSU EOS <code>remote.eos.ncsu.edu</code> servers. It requires no additional configuration except choosing the build target, and output file. Here is a repeatable script to perform the build and run the <code>project2</code> target executable:</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Hazel</h2>
<p>There are two ways to do run jobs on Hazel, currently, we support the interactive mode option. </p>
<h3><a class="anchor" id="autotoc_md4"></a>
Interactive Mode</h3>
<p>This mode requires a few additional steps, but for the most part, it follows the same process as the EOS server. </p><div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line"> </div>
<div class="line"># Start by logging in</div>
<div class="line">ssh login.hpc.ncsu.edu</div>
<div class="line"> </div>
<div class="line"># Then, start an interactive session</div>
<div class="line">bsub -Is -n 4 -R &quot;span[hosts=1]&quot; -W 20 bash</div>
<div class="line"> </div>
<div class="line"># Create a working directory, in this case we call it earthperson_project2 to avoid naming conflicts</div>
<div class="line">mkdir -p /share/$GROUP/$USER/earthperson_project2</div>
<div class="line"> </div>
<div class="line"># Go into that directory.</div>
<div class="line">cd /share/$GROUP/$USER/earthperson_project2</div>
<div class="line"> </div>
<div class="line"># Load the build modules</div>
<div class="line">module load openmpi-gcc/openmpi4.1.0-gcc10.2.0 cmake/3.24.1</div>
<div class="line"> </div>
<div class="line"># Begin by copying the files over using rsync, scp, sftp, etc...</div>
<div class="line"># Then, assuming the repo root is the current directory:</div>
<div class="line"> </div>
<div class="line">## Specify the build target</div>
<div class="line">export BUILD_TARGET=project2</div>
<div class="line"> </div>
<div class="line">## Create the build directory, configure and compile the $BUILD_TARGET</div>
<div class="line">mkdir -p build &amp;&amp; cd build &amp;&amp; \</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release &amp;&amp; \</div>
<div class="line">make -j$(nproc) $BUILD_TARGET &amp;&amp; cd ../</div>
<div class="line"> </div>
<div class="line">## Specify the input and output files.</div>
<div class="line">## NOTE: This path is relative to the repo root directory</div>
<div class="line">export INPUT_PARAMETERS=./src/project/project2/examples/project2_example_input_parameters.json</div>
<div class="line">export INPUT_SOURCETERMS=./src/project/project2/examples/project2_example_source_terms.csv</div>
<div class="line">export OUTPUT_RESULTS=./src/project/project2/examples/project2_example_output_results.json</div>
<div class="line">export OUTPUT_COMPUTED_FLUX=./src/project/project2/examples/project2_example_computed_flux</div>
<div class="line"> </div>
<div class="line">## Execute</div>
<div class="line">./build/bin/$BUILD_TARGET -i $INPUT_PARAMETERS -s $INPUT_SOURCETERMS -o $OUTPUT_RESULTS -f $OUTPUT_COMPUTED_FLUX</div>
</div><!-- fragment --> <h3><a class="anchor" id="autotoc_md5"></a>
Batch Jobs</h3>
<p>Coming Soon</p>
<h2><a class="anchor" id="autotoc_md6"></a>
EOS</h2>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line"> </div>
<div class="line"># Begin by copying the files over using rsync, scp, sftp, etc...</div>
<div class="line"># Then, assuming the repo root is the current directory:</div>
<div class="line"> </div>
<div class="line">## Specify the build target</div>
<div class="line">export BUILD_TARGET=project2</div>
<div class="line"> </div>
<div class="line">## Create the build directory, configure and compile the $BUILD_TARGET</div>
<div class="line">mkdir -p build &amp;&amp; cd build &amp;&amp; \</div>
<div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release &amp;&amp; \</div>
<div class="line">make -j$(nproc) $BUILD_TARGET &amp;&amp; cd ../</div>
<div class="line"> </div>
<div class="line">## Specify the input and output files.</div>
<div class="line">## NOTE: This path is relative to the repo root directory</div>
<div class="line">export INPUT_PARAMETERS=./src/project/project2/examples/project2_example_input_parameters.json</div>
<div class="line">export INPUT_SOURCETERMS=./src/project/project2/examples/project2_example_source_terms.csv</div>
<div class="line"> </div>
<div class="line">export OUTPUT_RESULTS=./src/project/project2/examples/project2_example_output_results.json</div>
<div class="line">export OUTPUT_COMPUTED_FLUX=./src/project/project2/examples/project2_example_computed_flux</div>
<div class="line"> </div>
<div class="line">## Execute</div>
<div class="line">./build/bin/$BUILD_TARGET -i $INPUT_PARAMETERS -s $INPUT_SOURCETERMS -o $OUTPUT_RESULTS -f $OUTPUT_COMPUTED_FLUX</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Build Environments</h2>
<p>The entire codebase has been built and tested on the NCSU Hazel <code>login.hpc.ncsu.edu</code> and EOS <code>remote.eos.ncsu.edu</code> servers, which, as of Fall 2023, provide support for the following dependencies:</p>
<h3><a class="anchor" id="autotoc_md8"></a>
EOS</h3>
<ul>
<li><code>Boost : 1.83.0</code></li>
<li><code>C/C++ compiler : GNU 8.5.0</code></li>
</ul>
<h3><a class="anchor" id="autotoc_md9"></a>
Hazel</h3>
<ul>
<li><code>Boost : 1.83.0</code></li>
<li><code>C/C++ compiler : GNU 10.2.0</code></li>
<li><code>CUDA: 12.0.0</code></li>
<li><code>MPI: OpenMPI 4.1.0</code></li>
</ul>
<p>To facilitate local development, equivalent Dockerfiles have been created. Checkout <a href="eos.Dockerfile">eos.Dockerfile</a> and <a href="hazel.Dockerfile">hazel.Dockerfile</a> and the <a href="#docker-usage-guide">Docker instructions</a> below.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Class Project</h2>
<p>Currently supported project build targets include: </p><table class="doxtable">
<tr>
<th colspan="1" style="text-align:center;"><b>#</b> </th><th colspan="2" style="text-align:center;"><b><a class="el" href="db/d91/classProject.html" title="A generic class that represents a project that can be executed.">Project</a> Milestone</b>  </th></tr>
<tr>
<td>1 </td><td><code>✅ project1</code> <code>✅ project1_tests</code>  </td></tr>
<tr>
<td>2 </td><td><code>✅ project2</code> <code>✅ project2_tests</code> <code>✅ physics_diffusion_tests</code><code>✅ blas_tests</code>  </td></tr>
<tr>
<td>3 </td><td><code>✅ project3</code> <code>✅ project3_tests</code><code>✅ blas_tests</code>  </td></tr>
<tr>
<td>4 </td><td><code>✅ project4</code> <code>✅ project4_tests</code>  </td></tr>
<tr>
<td>5 </td><td><code>✅ project5</code> <code>✅ project5_tests</code>  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md11"></a>
InLabs and OutLabs</h2>
<p>Currently supported inlab, outlab build targets include:</p>
<table class="doxtable">
<tr>
<th colspan="1" style="text-align:center;"><b>#</b> </th><th colspan="1" style="text-align:center;"><b>InLab</b> </th><th colspan="1" style="text-align:center;"><b>OutLab</b>  </th></tr>
<tr>
<td>1 </td><td><code>✅ inlab1</code> </td><td><code>✅ outlab1</code>  </td></tr>
<tr>
<td>2 </td><td><code>✅ inlab2</code> </td><td><code>✅ outlab2</code>  </td></tr>
<tr>
<td>3 </td><td><code>✅ inlab3</code> </td><td><code>✅ outlab3</code>  </td></tr>
<tr>
<td>4 </td><td><code>✅ inlab4</code> </td><td><code>✅ outlab4</code> <code>✅ outlab4_tests</code>  </td></tr>
<tr>
<td>5 </td><td><code>✅ inlab5</code> </td><td><code>✅ outlab5</code> <code>✅ outlab5_tests</code>  </td></tr>
<tr>
<td>6 </td><td><code>✅ inlab6</code> <code>✅ inlab6_tests</code> </td><td><code>✅ outlab6</code> <code>✅ outlab6_tests</code>  </td></tr>
<tr>
<td>7 </td><td><code>✅ inlab7</code> </td><td><code>✅ outlab7</code> <code>✅ outlab7_tests</code>  </td></tr>
<tr>
<td>8 </td><td></td><td></td></tr>
<tr>
<td>10 </td><td><code>✅ inlab10</code> <code>✅ inlab10_tests</code> </td><td><code>✅ outlab10</code> <code>✅ outlab10_tests</code>  </td></tr>
<tr>
<td>11 </td><td></td><td></td></tr>
<tr>
<td>12 </td><td></td><td></td></tr>
<tr>
<td>13 </td><td></td><td></td></tr>
</table>
<h2><a class="anchor" id="autotoc_md12"></a>
Optional CMake Arguments</h2>
<p>Available options are:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">CMake Option   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BUILD_TESTS   </td><td class="markdownTableBodyNone">Build a separate test target (for e.g. <code>inlab1_tests</code>)   </td><td class="markdownTableBodyNone">ON    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">PORTABLE   </td><td class="markdownTableBodyNone">Build without explicitly setting flags <code>-march=native</code>, <code>-mfma</code>, <code>-mavx</code>, <code>-mavx2</code>, <code>-msse4.2</code>, trading speed for portability   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CODE_COVERAGE   </td><td class="markdownTableBodyNone">Perform code coverage analysis   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ENABLE_LTO   </td><td class="markdownTableBodyNone">Enable Link-Time Optimization   </td><td class="markdownTableBodyNone">ON    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ENABLE_PGO   </td><td class="markdownTableBodyNone">Enable Profile-Guided Optimization   </td><td class="markdownTableBodyNone">OFF    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ENABLE_CODE_QUALITY_CHECKS   </td><td class="markdownTableBodyNone">Enable extra compile-time warnings   </td><td class="markdownTableBodyNone">ON   </td></tr>
</table>
<p>To use these options, you can add them to the <code>cmake</code> command in the build script. For example, to build with tests, you would modify the <code>cmake</code> command as follows:</p>
<div class="fragment"><div class="line">cmake .. -DCMAKE_BUILD_TYPE=Release -DBUILD_TESTS=ON</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md13"></a>
Docker Usage Guide</h1>
<p>This repository contains Dockerfiles that are designed to mimic the OS and packages available on the <code>login.hpc.ncsu.edu</code> and <code>remote.eos.ncsu.edu</code> servers. These Dockerfiles also set up SSH for remote debugging access with tools such as <a href="#development---jetbrains-clion-support">JetBrains Clion</a>.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Why Docker?</h2>
<p>Docker is a platform that allows us to package our application and its dependencies into a container which can run on any Linux/macOS/Windows machine. This helps to eliminate the "it works on my machine" problem. In this case, the Dockerfiles were needed to ensure that the code can be built, run, and debugged in an environment that closely matches the <code>login.hpc.ncsu.edu</code> and <code>remote.eos.ncsu.edu</code> servers.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Building the Docker Image</h2>
<p>The current default [Dockerfile](Dockerfile) is a symlink to <a href="eos.Dockerfile">eos.Dockerfile</a>. You can change it to build for <a href="hazel.Dockerfile">hazel.Dockerfile</a> instead. Alternatively, you can always specify the Dockerfile to use using the <code>-f &lt;your.Dockerfile&gt;</code> option.</p>
<p>To simply run the executables, build an image from the [Dockerfile](Dockerfile) using the following command:</p>
<div class="fragment"><div class="line">docker build -t ne591:binary .</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
Running the Docker Container</h2>
<p>To run the Docker container, use the following command:</p>
<div class="fragment"><div class="line">docker run --rm -it ne591:binary</div>
</div><!-- fragment --><p>This command tells Docker to run the container interactively (i.e., it attaches a terminal session to the running container) and starts a bash shell.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Building and Running Tests</h2>
<p>The Dockerfile includes arguments for building tests and performance benchmarks. To build and run the tests, you can modify the <code>docker build</code> command as follows:</p>
<div class="fragment"><div class="line">docker build --build-arg CMAKE_BUILD_TESTS=ON -t ne591:binary .</div>
</div><!-- fragment --><p>Then, you can run the tests in the Docker container as you would normally do.</p>
<h1><a class="anchor" id="autotoc_md18"></a>
Development - JetBrains Clion Support</h1>
<p>You can use <a href="https://www.jetbrains.com/clion/">JetBrains Clion</a> as the debug environment. Use Docker as the debug toolchain.</p>
<h2><a class="anchor" id="autotoc_md19"></a>
Prerequisites</h2>
<ul>
<li>Docker</li>
<li>CLion</li>
</ul>
<ol type="1">
<li>In Clion, first set your terminal to Bash.<ol type="a">
<li>Go to <code>Settings / Preferences | Tools | Terminal</code></li>
<li>Under <code>Application Settings</code>, look for <code>Shell Path</code> and set it to <code>Bash</code>.</li>
</ol>
</li>
<li>Then, build the docker <code>debugger</code> target, and save the built image with the tag <code>eos:debugger</code>. ```shell docker build &ndash;target=debugger -t eos:debugger . ```</li>
</ol>
<h2><a class="anchor" id="autotoc_md20"></a>
Clion Docker Toolchain</h2>
<p>Developing in Clion using the Docker Toolchain provides a consistent experience. The debugging environment is an ephemeral Docker container based on the <code>eos:debugger</code> image you just built.</p>
<h3><a class="anchor" id="autotoc_md21"></a>
Instructions</h3>
<ol type="1">
<li>##### <a href="https://www.jetbrains.com/help/clion/clion-toolchains-in-docker.html#create-docker-toolchain">Create Docker Toolchain</a><ol type="a">
<li>Go to <code>Settings / Preferences | Build, Execution, Deployment | Toolchains</code>.</li>
<li>Click <code>Add toolchain</code> and select <code>Docker</code>.</li>
<li>Click the <code>screw nut icon</code> next to the <code>Docker</code> field to select a Docker image.<ol type="i">
<li>You can also configure a <code>Docker server</code> in <code>Settings / Preferences | Build, Execution, Deployment | Docker</code> and then select it in the toolchain settings.</li>
</ol>
</li>
<li>Select the Docker Image <code>eos:debugger</code> and wait until the tool detection finishes.</li>
<li>Set the <code>C Compiler</code> to <code>Let CMake Detect</code>. It should detect <code>gcc</code>.</li>
<li>Set the <code>C++ Compiler</code> to <code>Let CMake Detect</code>. It should detect <code>g++</code>.</li>
<li>Set the <code>Debugger</code> to <code>Docker GDB</code>.</li>
<li>Then save the settings.</li>
</ol>
</li>
<li>##### <a href="https://www.jetbrains.com/help/clion/clion-toolchains-in-docker.html#build-run-debug-docker">Build, Run, Debug with a Docker Toolchain</a><ol type="a">
<li>After configuring a Docker toolchain, you can select it in <code>CMake profiles</code> or in <code>Makefile</code> settings. Alternatively, move the toolchain to the top of the list to make it default.</li>
<li>The project folder will mount to the Docker container and building, running, and debugging will be performed in it. CLion will start the container and shut it down after the command is executed.</li>
</ol>
</li>
</ol>
<h2><a class="anchor" id="autotoc_md22"></a>
Troubleshooting</h2>
<ul>
<li>#### <a href="https://www.jetbrains.com/help/clion/clion-toolchains-in-docker.html#windows-performance">Improve Docker Toolchain performance on Windows</a><ul>
<li>To get better performance on Windows, we recommend using Docker with the WSL 2 backend.<ol type="1">
<li>Set up <code>Docker Desktop</code> with the <a href="https://docs.docker.com/desktop/windows/wsl/">WSL 2 backend</a>.</li>
<li>In the Docker desktop application, navigate to <code>Settings | Resources | WSL Integration</code> and enable integration with your WSL distribution.</li>
<li>Place the project sources into the WSL filesystem, then open it in CLion and configure a Docker toolchain.</li>
</ol>
</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md23"></a>
Clion Remote Debugging via SSH</h2>
<p>The Dockerfile sets up SSH for root access in the <code>ssh-debugger</code> stage. This allows you to connect to the running container using SSH and debug the code. To do this, you need to build the SSH target and run the container in the background with port 22 exposed:</p>
<div class="fragment"><div class="line">docker build --target=ssh-debugger -t ne591:ssh-debugger .</div>
<div class="line">docker run --privileged --name=eos-ssh-debugger -d -p 2222:22 -it ne591:ssh-debugger</div>
</div><!-- fragment --><p>Then, you can connect to the running container using SSH. Clion provides native support for debugging remotely. Follow <a href="https://www.jetbrains.com/help/clion/remote-projects-support.html">these instructions</a> to set it up.</p>
<div class="fragment"><div class="line">ssh root@localhost</div>
</div><!-- fragment --><p>The password for the root user is "debugger".</p>
<h1><a class="anchor" id="autotoc_md24"></a>
License</h1>
<p>This project is licensed under the <a href="http://unlicense.org/">Unlicense</a> - a license with no conditions whatsoever which dedicates works to the public domain. Unlicensed works, modifications, and larger works may be distributed under different terms and without source code.</p>
<p>However, note that this code uses libraries that are bound by their own licenses.</p>
<h1><a class="anchor" id="autotoc_md25"></a>
FAQs</h1>
<ul>
<li><b>This is a course project. Why all the extra effort?</b><ul>
<li>My hope is that a stripped version of this code can serve as boilerplate so future students can limit all the hair-pulling to their algorithms, instead of worrying about I/O and input validation. </li>
</ul>
</li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
